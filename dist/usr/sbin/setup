#!/usr/bin/env bash

# Don't continue execution after errors
set -e

HOSTNAME=$1

print_usage () {
  echo "Usage: setup HOSTNAME" >&2
}

app_setup () {
  cd /var/www/app/config

  if [ -f layout.rb.template ]; then
    cp layout.rb.template layout.rb
  fi
  cp database.yml.template database.yml
  cp shibboleth.yml.template shibboleth.yml
}

hostname_setup () {
  if [ "$HOSTNAME"x = x ]; then
    print_usage
    return 1
  fi

  hostname $HOSTNAME
}

nginx_setup () {
  cd /etc/nginx
}

_setup () {
  app_setup
  hostname_setup
  nginx_setup
}

_setup
